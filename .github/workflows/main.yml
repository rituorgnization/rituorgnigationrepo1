name: ritupipeline
on:
 push:
  branches:
    -main
permissions:
 id-token: write
 contents: read
jobs:
 terraform:
  name: terraform init
  runs-on: self-hosted
  steps: 
     - name: Checkout
       uses: actions/checkout@v5.0.0
     - name: Azure Login
       uses: Azure/login@v2.3.0
       with: 
        client-id: ${{ secrets.CLIENTID }}
        tenant-id: ${{ secrets.TENANTID }}
        subscription-id: ${{ secrets.SUBSCRIPTIONID }}
     - name: Terraform fmt
       id: fmt
       run: terraform fmt -check
       continue-on-error: true

     - name: Terraform Init
       id: init
       run: terraform init -input=false

     - name: Terraform Validate
       id: validate
       run: terraform validate -no-color

     - name: Terraform Plan
       id: plan
       run: terraform plan -no-color -input=false
       continue-on-error: true
         


   
 
